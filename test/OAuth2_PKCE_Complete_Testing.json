{
  "info": {
    "_postman_id": "oauth2-pkce-complete-testing",
    "name": "OAuth 2.0 + PKCE Complete Testing (íšŒì›ê°€ì…ë¶€í„°)",
    "description": "ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ë§ì¶˜ ì™„ì „í•œ í…ŒìŠ¤íŠ¸: íšŒì›ê°€ì… â†’ ì´ë©”ì¼ ê²€ì¦ â†’ OAuth ë¡œê·¸ì¸ â†’ í† í° ì‚¬ìš©",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Section 0: Setup",
      "item": [
        {
          "name": "0-1. Register OAuth Client",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Status code is 201', function() {",
                  "  pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('âœ… Client registered successfully', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response).to.have.property('message');",
                  "  pm.expect(response).to.have.property('client');",
                  "  pm.expect(response.client).to.have.property('clientId');",
                  "  pm.expect(response.client).to.have.property('clientSecret');",
                  "});",
                  "",
                  "// Store client credentials",
                  "const response = pm.response.json();",
                  "pm.collectionVariables.set('client_id', response.client.clientId);",
                  "pm.collectionVariables.set('client_secret', response.client.clientSecret);",
                  "",
                  "console.log('âœ… OAuth Client Registered');",
                  "console.log('Client ID: ' + response.client.clientId);",
                  "console.log('âš ï¸  Save client_secret: ' + response.client.clientSecret);"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Test Mobile App\",\n  \"description\": \"OAuth 2.0 í…ŒìŠ¤íŠ¸ìš© ëª¨ë°”ì¼ ì•±\",\n  \"frontendUrl\": \"http://localhost:3000\",\n  \"redirectUris\": [\n    \"http://localhost:3000/callback\",\n    \"http://localhost:3001/callback\"\n  ],\n  \"maxTokensPerUser\": 5\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/clients/register",
              "host": ["{{base_url}}"],
              "path": ["api", "clients", "register"]
            },
            "description": "ğŸ”§ Step 0-1: OAuth í´ë¼ì´ì–¸íŠ¸(ì•±) ë“±ë¡\n\nì•±/ì›¹ì‚¬ì´íŠ¸ë¥¼ OAuth ì‹œìŠ¤í…œì— ë“±ë¡í•©ë‹ˆë‹¤.\n\nâœ… client_idì™€ client_secretì´ ìë™ìœ¼ë¡œ ë³€ìˆ˜ì— ì €ì¥ë©ë‹ˆë‹¤."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Section 1: User Registration",
      "item": [
        {
          "name": "1-1. User Registration",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Status code is 201', function() {",
                  "  pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('âœ… Registration successful', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response).to.have.property('message');",
                  "  pm.expect(response.message).to.include('Registration successful');",
                  "});",
                  "",
                  "console.log('âœ… User Registration Completed');",
                  "console.log('âš ï¸  Next: Email verification required (check DB or email)');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"username\": \"{{username}}\",\n  \"password\": \"{{password}}\",\n  \"firstName\": \"Test\",\n  \"lastName\": \"User\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/register",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "register"]
            },
            "description": "ğŸ“ Step 1-1: ì‚¬ìš©ì íšŒì›ê°€ì…\n\nìƒˆë¡œìš´ ì‚¬ìš©ì ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\nâš ï¸  ë‹¤ìŒ ë‹¨ê³„: Section 2ì—ì„œ ì´ë©”ì¼ ê²€ì¦ í•„ìš”"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Section 2: Email Verification",
      "item": [
        {
          "name": "2-1. [Manual] Verify Email in DB",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}",
              "host": ["{{base_url}}"]
            },
            "description": "ğŸ“§ Step 2-1: ì´ë©”ì¼ ê²€ì¦ (ìˆ˜ë™)\n\n**ì´ ë‹¨ê³„ëŠ” Postmanì´ ì•„ë‹Œ DBì—ì„œ ì§ì ‘ ì‹¤í–‰í•©ë‹ˆë‹¤:**\n\n```sql\nUPDATE users\nSET email_verified = true\nWHERE email = 'testuser@example.com';\n```\n\n**í™•ì¸:**\n```sql\nSELECT email, email_verified, enabled\nFROM users\nWHERE email = 'testuser@example.com';\n```\n\nâœ… ì™„ë£Œ í›„ Section 3ë¡œ ì´ë™"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Section 3: OAuth 2.0 + PKCE Login",
      "item": [
        {
          "name": "3-1. Generate Code Challenge",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Generate random code_verifier (128 characters - RFC 7636)",
                  "const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~';",
                  "let codeVerifier = '';",
                  "for (let i = 0; i < 128; i++) {",
                  "  codeVerifier += chars.charAt(Math.floor(Math.random() * chars.length));",
                  "}",
                  "",
                  "// Generate code_challenge using SHA-256 + Base64URL encoding",
                  "const hash = CryptoJS.SHA256(codeVerifier);",
                  "const codeChallenge = CryptoJS.enc.Base64.stringify(hash)",
                  "  .replace(/\\+/g, '-')",
                  "  .replace(/\\//g, '_')",
                  "  .replace(/=/g, '');",
                  "",
                  "// Generate random state (CSRF protection)",
                  "const state = pm.variables.replaceIn('{{$randomUUID}}');",
                  "",
                  "// Store in collection variables",
                  "pm.collectionVariables.set('code_verifier', codeVerifier);",
                  "pm.collectionVariables.set('code_challenge', codeChallenge);",
                  "pm.collectionVariables.set('state', state);",
                  "",
                  "console.log('âœ… PKCE Values Generated');",
                  "console.log('Code Verifier: ' + codeVerifier.substring(0, 20) + '...');",
                  "console.log('Code Challenge: ' + codeChallenge);",
                  "console.log('State: ' + state);"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}",
              "host": ["{{base_url}}"]
            },
            "description": "ğŸ” Step 3-1: PKCE Code Challenge ìƒì„±\n\nPre-request Scriptë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤ (ì‹¤ì œ HTTP ìš”ì²­ ì—†ìŒ).\n\nìƒì„±ë˜ëŠ” ê°’:\n- code_verifier (128ì)\n- code_challenge (SHA256 í•´ì‹œ)\n- state (CSRF ë°©ì§€)\n\nâœ… Consoleì—ì„œ ìƒì„±ëœ ê°’ í™•ì¸"
          },
          "response": []
        },
        {
          "name": "3-2. Authorization Request (with PKCE)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/oauth/authorize?client_id={{client_id}}&redirect_uri={{redirect_uri}}&response_type=code&state={{state}}&code_challenge={{code_challenge}}&code_challenge_method=S256",
              "host": ["{{base_url}}"],
              "path": ["oauth", "authorize"],
              "query": [
                {
                  "key": "client_id",
                  "value": "{{client_id}}"
                },
                {
                  "key": "redirect_uri",
                  "value": "{{redirect_uri}}"
                },
                {
                  "key": "response_type",
                  "value": "code"
                },
                {
                  "key": "state",
                  "value": "{{state}}"
                },
                {
                  "key": "code_challenge",
                  "value": "{{code_challenge}}"
                },
                {
                  "key": "code_challenge_method",
                  "value": "S256"
                }
              ]
            },
            "description": "ğŸŒ Step 3-2: Authorization ìš”ì²­ (PKCE í¬í•¨)\n\në¡œê·¸ì¸ í˜ì´ì§€ë¥¼ ìš”ì²­í•©ë‹ˆë‹¤.\n\nì˜ˆìƒ ì‘ë‹µ:\n- HTML ë¡œê·¸ì¸ í¼\n- ìˆ¨ê²¨ì§„ í•„ë“œì— code_challenge í¬í•¨\n\nì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì €ì—ì„œ ì´ URLì„ ë°©ë¬¸í•©ë‹ˆë‹¤."
          },
          "response": []
        },
        {
          "name": "3-3. Login & Get Authorization Code",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Extract authorization code from Location header",
                  "const location = pm.response.headers.get('Location');",
                  "console.log('ğŸ“ Redirect Location: ' + location);",
                  "",
                  "if (location) {",
                  "  try {",
                  "    const url = new URL(location);",
                  "    const authCode = url.searchParams.get('code');",
                  "    const returnedState = url.searchParams.get('state');",
                  "    ",
                  "    pm.collectionVariables.set('authorization_code', authCode);",
                  "    ",
                  "    pm.test('âœ… Status is 302 (redirect)', function() {",
                  "      pm.expect(pm.response.code).to.equal(302);",
                  "    });",
                  "    ",
                  "    pm.test('âœ… Authorization Code received', function() {",
                  "      pm.expect(authCode).to.exist;",
                  "      pm.expect(authCode).to.not.be.empty;",
                  "    });",
                  "    ",
                  "    pm.test('âœ… State parameter matches', function() {",
                  "      pm.expect(returnedState).to.equal(pm.collectionVariables.get('state'));",
                  "    });",
                  "    ",
                  "    console.log('âœ… Authorization Code: ' + authCode.substring(0, 20) + '...');",
                  "    console.log('âœ… State verified');",
                  "  } catch (e) {",
                  "    console.error('âš ï¸  Error parsing redirect URL: ' + e);",
                  "  }",
                  "} else {",
                  "  console.warn('âš ï¸  No Location header found');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "email",
                  "value": "{{email}}"
                },
                {
                  "key": "password",
                  "value": "{{password}}"
                },
                {
                  "key": "client_id",
                  "value": "{{client_id}}"
                },
                {
                  "key": "redirect_uri",
                  "value": "{{redirect_uri}}"
                },
                {
                  "key": "state",
                  "value": "{{state}}"
                },
                {
                  "key": "code_challenge",
                  "value": "{{code_challenge}}"
                },
                {
                  "key": "code_challenge_method",
                  "value": "S256"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/oauth/login",
              "host": ["{{base_url}}"],
              "path": ["oauth", "login"]
            },
            "description": "ğŸ”‘ Step 3-3: ë¡œê·¸ì¸ & Authorization Code íšë“\n\nì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•˜ì—¬ Authorization Codeë¥¼ ë°›ìŠµë‹ˆë‹¤.\n\nâš ï¸  Postman Settings:\n- \"Automatically follow redirects\" OFF\n\nì˜ˆìƒ:\n- 302 Redirect\n- Location headerì— authorization_code í¬í•¨\n- authorization_codeê°€ ìë™ìœ¼ë¡œ ë³€ìˆ˜ì— ì €ì¥ë¨"
          },
          "response": []
        },
        {
          "name": "3-4. Token Exchange (with PKCE)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Status code is 200', function() {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('âœ… Response contains tokens', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response).to.have.property('access_token');",
                  "  pm.expect(response).to.have.property('refresh_token');",
                  "  pm.expect(response).to.have.property('token_type');",
                  "  pm.expect(response.token_type).to.equal('Bearer');",
                  "});",
                  "",
                  "// Store tokens",
                  "const response = pm.response.json();",
                  "pm.collectionVariables.set('access_token', response.access_token);",
                  "pm.collectionVariables.set('refresh_token', response.refresh_token);",
                  "",
                  "console.log('âœ… PKCE Flow Completed Successfully!');",
                  "console.log('Access Token: ' + response.access_token.substring(0, 30) + '...');",
                  "console.log('Refresh Token: ' + response.refresh_token.substring(0, 30) + '...');",
                  "console.log('Token Type: ' + response.token_type);",
                  "console.log('Expires In: ' + response.expires_in + 'ms');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "authorization_code"
                },
                {
                  "key": "code",
                  "value": "{{authorization_code}}"
                },
                {
                  "key": "client_id",
                  "value": "{{client_id}}"
                },
                {
                  "key": "client_secret",
                  "value": "{{client_secret}}"
                },
                {
                  "key": "redirect_uri",
                  "value": "{{redirect_uri}}"
                },
                {
                  "key": "code_verifier",
                  "value": "{{code_verifier}}"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/oauth/token",
              "host": ["{{base_url}}"],
              "path": ["oauth", "token"]
            },
            "description": "ğŸ‰ Step 3-4: Token Exchange (PKCE Verification)\n\nAuthorization Codeë¥¼ Access Tokenìœ¼ë¡œ êµí™˜í•©ë‹ˆë‹¤.\n\nâš ï¸  CRITICAL:\n- code_verifierê°€ 3-1ì—ì„œ ìƒì„±í•œ ê°’ê³¼ ì¼ì¹˜í•´ì•¼ í•¨\n- ì„œë²„ê°€ SHA256(code_verifier) == code_challenge ê²€ì¦\n\nì„±ê³µ ì‹œ:\n- access_token (24ì‹œê°„ ìœ íš¨)\n- refresh_token (7ì¼ ìœ íš¨)\n- ìë™ìœ¼ë¡œ ë³€ìˆ˜ì— ì €ì¥ë¨"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Section 4: Token Usage & Session Management",
      "item": [
        {
          "name": "4-1. OAuth Refresh Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Status code is 200', function() {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('âœ… New tokens received', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response).to.have.property('access_token');",
                  "  pm.expect(response).to.have.property('refresh_token');",
                  "  pm.expect(response).to.have.property('token_type');",
                  "});",
                  "",
                  "// Update tokens",
                  "const response = pm.response.json();",
                  "pm.collectionVariables.set('access_token', response.access_token);",
                  "pm.collectionVariables.set('refresh_token', response.refresh_token);",
                  "",
                  "console.log('âœ… Tokens refreshed successfully (with session rotation)');",
                  "console.log('New Access Token: ' + response.access_token.substring(0, 30) + '...');",
                  "console.log('New Refresh Token: ' + response.refresh_token.substring(0, 30) + '...');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "refresh_token"
                },
                {
                  "key": "refresh_token",
                  "value": "{{refresh_token}}"
                },
                {
                  "key": "client_id",
                  "value": "{{client_id}}"
                },
                {
                  "key": "client_secret",
                  "value": "{{client_secret}}"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/oauth/token",
              "host": ["{{base_url}}"],
              "path": ["oauth", "token"]
            },
            "description": "ğŸ”„ Step 4-1: OAuth Refresh Tokenìœ¼ë¡œ ìƒˆ Access Token ë°œê¸‰\n\ngrant_type=refresh_tokenì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\n\nâš ï¸  ì¤‘ìš”:\n- í† í° ë¡œí…Œì´ì…˜: ìƒˆ Refresh Tokenë„ ë°œê¸‰ë¨ (ê¸°ì¡´ ë¬´íš¨í™”)\n- ì„¸ì…˜ ê´€ë¦¬: ìë™ìœ¼ë¡œ ìƒˆ ì„¸ì…˜ ìƒì„±\n- ë°˜ë“œì‹œ ìƒˆ í† í°ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•„ìš”"
          },
          "response": []
        },
        {
          "name": "4-2. OAuth Logout",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Status code is 200', function() {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('âœ… Logout successful', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response.success).to.equal(true);",
                  "  pm.expect(response.message).to.equal('Logged out successfully');",
                  "});",
                  "",
                  "console.log('âœ… OAuth Logout successful');",
                  "console.log('âš ï¸  Session invalidated, tokens blacklisted');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refresh_token\": \"{{refresh_token}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/oauth/logout",
              "host": ["{{base_url}}"],
              "path": ["oauth", "logout"]
            },
            "description": "ğŸšª Step 4-2: OAuth ë¡œê·¸ì•„ì›ƒ\n\nì„¸ì…˜ì„ ë¬´íš¨í™”í•˜ê³  í† í°ì„ ë¸”ë™ë¦¬ìŠ¤íŠ¸ì— ë“±ë¡í•©ë‹ˆë‹¤.\n\nâš ï¸  ì¤‘ìš”:\n- ì¸ì¦ í•„ìš”: Authorization í—¤ë”ì— Access Token\n- ì„¸ì…˜ ë¬´íš¨í™”: í•´ë‹¹ ì„¸ì…˜ ì¦‰ì‹œ ë¬´íš¨í™”\n- í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸: JTIê°€ Redisì— ë“±ë¡ë¨"
          },
          "response": []
        },
        {
          "name": "4-3. Get Active Sessions",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Status code is 200', function() {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('âœ… Sessions list received', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response).to.have.property('sessions');",
                  "  pm.expect(response).to.have.property('totalCount');",
                  "});",
                  "",
                  "const response = pm.response.json();",
                  "console.log('âœ… Active Sessions: ' + response.totalCount);",
                  "if (response.sessions && response.sessions.length > 0) {",
                  "  pm.collectionVariables.set('session_id', response.sessions[0].sessionId);",
                  "  console.log('First Session ID saved for revoke test');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sessions",
              "host": ["{{base_url}}"],
              "path": ["api", "sessions"]
            },
            "description": "ğŸ“‹ Step 4-3: í™œì„± ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ\n\ní˜„ì¬ ë¡œê·¸ì¸ëœ ëª¨ë“  ê¸°ê¸°/ì„¸ì…˜ì„ ì¡°íšŒí•©ë‹ˆë‹¤.\n\nì‘ë‹µ í¬í•¨ ì •ë³´:\n- ì„¸ì…˜ ID\n- ê¸°ê¸° ì¢…ë¥˜ (Desktop, Mobile ë“±)\n- IP ì£¼ì†Œ\n- ìœ„ì¹˜\n- ë§ˆì§€ë§‰ í™œë™ ì‹œê°„\n- í˜„ì¬ ì„¸ì…˜ ì—¬ë¶€"
          },
          "response": []
        },
        {
          "name": "4-4. Revoke Session (Remote Logout)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Status code is 200', function() {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('âœ… Session revoked', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response.success).to.equal(true);",
                  "});",
                  "",
                  "console.log('âœ… Session revoked successfully');"
                ]
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sessions/{{session_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "sessions", "{{session_id}}"]
            },
            "description": "ğŸ”’ Step 4-4: íŠ¹ì • ì„¸ì…˜ ë¬´íš¨í™” (ì›ê²© ë¡œê·¸ì•„ì›ƒ)\n\në‹¤ë¥¸ ê¸°ê¸°ì˜ ì„¸ì…˜ì„ ì›ê²©ìœ¼ë¡œ ì¢…ë£Œí•©ë‹ˆë‹¤.\n\nâš ï¸  ì£¼ì˜:\n- session_idëŠ” 4-3ì—ì„œ ì¡°íšŒí•œ ê°’ ì‚¬ìš©\n- í˜„ì¬ ì„¸ì…˜ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì„¸ì…˜ë§Œ ë¬´íš¨í™” ê°€ëŠ¥"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Section 5: Error Tests",
      "item": [
        {
          "name": "5-1. Error: Invalid code_verifier",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âŒ Status code is 400', function() {",
                  "  pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('âŒ Error is invalid_grant', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response.error).to.equal('invalid_grant');",
                  "});",
                  "",
                  "console.log('âŒ PKCE Verification Failed (Expected)');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "authorization_code"
                },
                {
                  "key": "code",
                  "value": "{{authorization_code}}"
                },
                {
                  "key": "client_id",
                  "value": "{{client_id}}"
                },
                {
                  "key": "client_secret",
                  "value": "{{client_secret}}"
                },
                {
                  "key": "redirect_uri",
                  "value": "{{redirect_uri}}"
                },
                {
                  "key": "code_verifier",
                  "value": "WRONG_VERIFIER"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/oauth/token",
              "host": ["{{base_url}}"],
              "path": ["oauth", "token"]
            },
            "description": "ğŸ§ª ERROR TEST: ì˜ëª»ëœ code_verifier\n\nì˜ˆìƒ ê²°ê³¼:\nâŒ 400 Bad Request\nâŒ error: invalid_grant\nâŒ PKCE verification failed"
          },
          "response": []
        },
        {
          "name": "5-2. Error: Missing code_verifier",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âŒ Status code is 400', function() {",
                  "  pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('âŒ Error mentions code_verifier', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response.error).to.equal('invalid_grant');",
                  "  pm.expect(response.error_description).to.include('code_verifier');",
                  "});",
                  "",
                  "console.log('âŒ code_verifier required (Expected)');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "authorization_code"
                },
                {
                  "key": "code",
                  "value": "{{authorization_code}}"
                },
                {
                  "key": "client_id",
                  "value": "{{client_id}}"
                },
                {
                  "key": "client_secret",
                  "value": "{{client_secret}}"
                },
                {
                  "key": "redirect_uri",
                  "value": "{{redirect_uri}}"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/oauth/token",
              "host": ["{{base_url}}"],
              "path": ["oauth", "token"]
            },
            "description": "ğŸ§ª ERROR TEST: code_verifier ëˆ„ë½\n\ncode_challengeë¥¼ ì‚¬ìš©í–ˆìœ¼ë¯€ë¡œ code_verifierëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.\n\nì˜ˆìƒ ê²°ê³¼:\nâŒ 400 Bad Request\nâŒ error: invalid_grant\nâŒ code_verifier is required"
          },
          "response": []
        },
        {
          "name": "5-3. Error: Reuse Authorization Code",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âŒ Status code is 400', function() {",
                  "  pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('âŒ Code already used', function() {",
                  "  const response = pm.response.json();",
                  "  pm.expect(response.error).to.equal('invalid_grant');",
                  "});",
                  "",
                  "console.log('âŒ Authorization Code already used (Expected)');"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "authorization_code"
                },
                {
                  "key": "code",
                  "value": "{{authorization_code}}"
                },
                {
                  "key": "client_id",
                  "value": "{{client_id}}"
                },
                {
                  "key": "client_secret",
                  "value": "{{client_secret}}"
                },
                {
                  "key": "redirect_uri",
                  "value": "{{redirect_uri}}"
                },
                {
                  "key": "code_verifier",
                  "value": "{{code_verifier}}"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/oauth/token",
              "host": ["{{base_url}}"],
              "path": ["oauth", "token"]
            },
            "description": "ğŸ§ª ERROR TEST: Authorization Code ì¬ì‚¬ìš©\n\n3-4ì—ì„œ ì´ë¯¸ ì‚¬ìš©í•œ codeë¥¼ ë‹¤ì‹œ ì‚¬ìš© ì‹œë„.\n\nì˜ˆìƒ ê²°ê³¼:\nâŒ 400 Bad Request\nâŒ error: invalid_grant\nâŒ Authorization code already used\n\nì´ìœ : Authorization CodeëŠ” ì¼íšŒì„±ì…ë‹ˆë‹¤."
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "redirect_uri",
      "value": "http://localhost:3000/callback",
      "type": "string"
    },
    {
      "key": "email",
      "value": "tiaaa0012@gmail.com",
      "type": "string"
    },
    {
      "key": "username",
      "value": "testuser",
      "type": "string"
    },
    {
      "key": "password",
      "value": "TestPassword123!",
      "type": "string"
    },
    {
      "key": "client_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "client_secret",
      "value": "",
      "type": "string"
    },
    {
      "key": "code_verifier",
      "value": "",
      "type": "string"
    },
    {
      "key": "code_challenge",
      "value": "",
      "type": "string"
    },
    {
      "key": "state",
      "value": "",
      "type": "string"
    },
    {
      "key": "authorization_code",
      "value": "",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "refresh_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "session_id",
      "value": "",
      "type": "string"
    }
  ]
}
